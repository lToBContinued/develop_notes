# 进程

electron 中有两个进程：**主进程**和**渲染进程**

1. **主进程**：启动项目时运行的 main.js 文件就是我们说的主进程。在主进程运行的脚本可以以创建 web 页面的形式展示 GUI。**主进程只有一个**。
2. **渲染进程**：每个 electron 的页面都在运行着自己的进程，这样的进程称之为渲染进程（基于 chromium 的多进程结构）

[![pEnBznI.png](https://s21.ax1x.com/2025/02/10/pEnBznI.png)](https://imgse.com/i/pEnBznI)

主进程使用 BrowserWindow 创建实例，主进程销毁后，对应的渲染进程会被终止。主进程与渲染进程通过 IPC 方式（事件驱动）进行通信。

## 主进程

### 主进程事件生命周期

#### 窗口的关闭

window-all-closed

在 Windows 和 Linux 上，我们通常希望在关闭一个应用的所有窗口后让它退出。

```js
app.on('window-all-closed', () => {
  // 当所有窗口都被关闭时，执行以下代码
  if (process.platform !== 'darwin') {
    // 如果当前平台不是 macOS（darwin），则退出应用程序
    app.quit()
  }
})
```

#### 窗口的打开

activate

与前二者相比，即使没有打开任何窗口，macOS 应用通常也会继续运行。在没有窗口可用时调用 app 会打开一个新窗口。

因为窗口无法在 ready 事件前创建，你应当在你的应用初始化后仅监听 activate 事件。 要实现这个，仅监听 whenReady() 回调即可。

```js
app.whenReady().then(() => {
  createWindow()

  app.on('activate', ()=>{
    // 当应用程序被激活时，执行以下代码
    if (BrowserWindow.getAllWindows().length === 0) {
      // 如果当前没有打开的窗口，则创建一个新窗口
      createWindow()
    }
  })
})
```
