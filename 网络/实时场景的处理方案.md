# 实时场景的处理方案

## 短轮询（short polling）

短轮询是一种 “ 话痨式 ” 的方式，客户端每隔一小段时间就向服务器请求一次，询问有没有新消息。

[![pEXBxyQ.jpg](https://s21.ax1x.com/2025/05/12/pEXBxyQ.jpg)](https://imgse.com/i/pEXBxyQ)

例如你可以这样实现一个简单的短轮询：

```js
function Polling() {
    fetch('http://www.your_example_server.com').then(data => {
        // somthing
    }).catch(err => {
        console.log(err)
    })
}
setInterval(polling, 5000) // 使用定时器来实现定时发送查询结果
```

优点：可以看到实现非常简单，它的**兼容性**也比较好的只要**支持http协议**就可以用这种方式实现。

缺点：但是它的缺点也很明显就是非常的消耗资源，因为建立`Tcp`连接是非常消耗资源的，服务端响应完成就会关闭这个`Tcp`连接，下一次请求再次建立`Tcp`连接。而且实时性并不高，因为定时器是有延时的。

## 长轮询（long polling）

客户端发送请求后服务器端**不会立即**返回数据，服务器端会**阻塞请求**连接不会**立即断开**，直到服务器端**有数据更新或者是连接超时**才返回，客户端才再次发出请求新建连接、如此反复从而获取最新数据。大致效果如下：

[![pEXDiF0.png](https://s21.ax1x.com/2025/05/12/pEXDiF0.png)](https://imgse.com/i/pEXDiF0)

